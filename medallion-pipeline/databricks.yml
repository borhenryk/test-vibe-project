# Medallion Architecture Pipeline - Databricks Asset Bundle
# This bundle deploys a complete Bronze → Silver → Gold data engineering pipeline

bundle:
  name: medallion_pipeline

variables:
  catalog:
    description: "Unity Catalog name"
    default: "dbdemos_henryk"
  schema:
    description: "Schema name for medallion tables"
    default: "medallion_pipeline"

# Note: workspace.host is configured via DATABRICKS_HOST environment variable
# which is set from GitHub secrets in CI/CD

include:
  - resources/*.yml

targets:
  dev:
    mode: development
    default: true
    workspace:
      root_path: /Workspace/Users/${workspace.current_user.userName}/.bundle/${bundle.name}/${bundle.target}

  staging:
    mode: development
    workspace:
      root_path: /Workspace/Users/${workspace.current_user.userName}/.bundle/${bundle.name}/${bundle.target}

  prod:
    mode: production
    workspace:
      root_path: /Workspace/Users/${workspace.current_user.userName}/.bundle/${bundle.name}/${bundle.target}
    run_as:
      user_name: ${workspace.current_user.userName}
